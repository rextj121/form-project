$(document).ready(function(){
    $(".get_student").on("click", function() {
        var stdid = $(this).attr('id');
    $('#std_id').val(stdid);
    });
});




function refresh_data(){
                
                      var schid = $('#school_id').val();   
                      var sess = $('#session').val();
                      var sterm = $('#term').val();
                      var scls = $('#class').val();
                      var subj = $('#subject').val();
                      var tchid = $('#tid').val();

                        
                      $.post('load_score_sheet.php', 
                        {
                         sid:schid,
                         session:sess,
                         term:sterm,
                         sclass:scls,
                         subject:subj,
                         tid:tchid
                          
                        },
                        function(data){
                            $('#score_sheet').html(data);
                        }
                      );
                       
                     
}



function refresh_edit_score(){
               
                        
                      var schid = $('#school_id').val();   
                      var sess = $('#session').val();
                      var sterm = $('#term').val();
                      var scls = $('#class').val();
                      var subj = $('#subject').val();

                        
                      $.post('load_editable_score_sheet.php', 
                        {
                         sid:schid,
                         session:sess,
                         term:sterm,
                         sclass:scls,
                         subject:subj
                          
                        },
                        function(data){
                            $('#score_sheet_edit').html(data);
                        }
                      );
                      
}


function post_score(){
    //save score
                  
                      var schid = $('#school_id').val();   
                      var sess = $('#session').val();
                      var sterm = $('#term').val();
                      var scls = $('#class').val();
                      var subj = $('#subject').val();
                      var adno = $('#std_id').val();
                      var sca = $('#ca').val();
                      var tca = $('#tot_ca').val();
                      var exm = $('#exam').val();
                      var tot = $('#total').val();
                      var grd = $('#grade').val();
                      var rmk = $('#remark').val();
                      var td = $('#tid').val();

                        
                      $.post('post_score_sheet.php', 
                        {
                         sid:schid,
                         tid:td,
                         session:sess,
                         term:sterm,
                         cls:scls,
                         subject:subj,
                         stid:adno,
                         ca:sca,
                         totca:tca,
                         exam:exm,
                         total:tot,
                         grade:grd,
                         remark:rmk
                          
                        },
                        function(data){
                            alert(data);
                            refresh_data();
                        }
                    );
 
}



function update_score(){
     //save score
                  
                      var schid = $('#school_id').val();   
                      var sess = $('#session').val();
                      var sterm = $('#term').val();
                      var scls = $('#class').val();
                      var subj = $('#subject').val();
                      var adno = $('#st_id').val();
                      var sca = $('#ca').val();
                      var exm = $('#exam').val();
                      var tot = $('#total').val();
                      var grd = $('#grade').val();
                      var rmk = $('#remark').val();

                        
                      $.post('edit_score_sheet.php', 
                        {
                         sid:schid,
                         session:sess,
                         term:sterm,
                         cls:scls,
                         subject:subj,
                         stid:adno,
                         ca:sca,
                         exam:exm,
                         total:tot,
                         grade:grd,
                         remark:rmk
                          
                        },
                        function(data){
                            alert(data);
                            refresh_edit_score();
                        }
                    );
}


function toggleMenu(){
   // $('#admin-menu').fadeToggle(1000);
    $('#admin-menu').slideToggle(500);
}





function get_std_drop_list_by_class(){
    
    /*
    
    var school_id = $('#school_id').val();
     var class_id = this.$id.val();
    
     $.post('../../resources/functions/student_by_class_drop_list.php',
           {
              sid:school_id,
              cid:class_id
           },
          function(data){
             //$('#student_id').val(data
            alert(data);
          }
    );
*/
}




function calculate_score(){
    var ca = Number($('#ca').val());
    var xm = Number($('#exam').val());
    var total_score, total_ca;
    
    
    if(ca > 40){
        //calculate total ca
        total_ca = Math.floor(ca * 0.4);
        $('#tot_ca').val(total_ca); 
    }else{
        total_ca = ca;
        $('#tot_ca').val(total_ca); 
    }
    
    
    
    //calculate total score
    total_score = Math.floor(total_ca + xm);
    $('#total').val(total_score);
    
    
    
    //grade students
    
    if(total_score >= 90){
        $('#grade').val('A+');
    }else if(total_score >= 80){
        $('#grade').val('A');
    }else if(total_score >= 70){
        $('#grade').val('B');
    }else if(total_score >= 60){
        $('#grade').val('C+');
    }else if(total_score >= 50){
        $('#grade').val('C');
    }else if(total_score >= 40){
        $('#grade').val('D');
    }else if(total_score >= 30){
        $('#grade').val('E');
    }else if(total_score < 30){
        $('#grade').val('F');
    }
    
}